# 七牛云域名配置说明

## ❌ 不能使用 Vercel 域名

**重要**：`QINIU_DOMAIN` 环境变量**不能**使用 Vercel 的域名（如：`https://survival-skills-ceco.vercel.app/`）

### 原因

1. **Vercel 域名是网站域名**，不是文件存储域名
2. **七牛云需要自己的域名**来访问存储的文件
3. 两者是不同的服务，不能混用

## ✅ 正确的配置方式

### 方式 1：使用七牛云测试域名（最简单）

创建存储空间后，七牛云会自动分配一个测试域名：

**格式**：
```
http://空间名称.区域域名.qiniucs.com
```

**示例**：
```
http://survival-skills-pdfs.z0.glb.clouddn.com
```

**获取方法**：
1. 登录七牛云控制台
2. 进入您的存储空间
3. 点击"空间概览"或"域名管理"
4. 可以看到分配的测试域名

**配置**：
```
QINIU_DOMAIN=http://survival-skills-pdfs.z0.glb.clouddn.com
```

⚠️ **注意**：测试域名有 30 天有效期，之后需要绑定自定义域名。

### 方式 2：使用自定义域名（推荐，永久有效）

如果您有自己的域名（如：`yourdomain.com`），可以：

1. **在七牛云绑定自定义域名**：
   - 进入存储空间 → "域名管理" → "绑定域名"
   - 输入子域名（如：`pdfs.yourdomain.com`）

2. **在域名 DNS 添加 CNAME 记录**：
   - 主机记录：`pdfs`
   - 记录类型：`CNAME`
   - 记录值：七牛云提供的 CNAME 地址

3. **配置环境变量**：
   ```
   QINIU_DOMAIN=https://pdfs.yourdomain.com
   ```

## 配置示例

### 正确的配置

```env
QINIU_ACCESS_KEY=your_access_key
QINIU_SECRET_KEY=your_secret_key
QINIU_BUCKET_NAME=survival-skills-pdfs
QINIU_DOMAIN=http://survival-skills-pdfs.z0.glb.clouddn.com
```

### ❌ 错误的配置

```env
# 错误：不能使用 Vercel 域名
QINIU_DOMAIN=https://survival-skills-ceco.vercel.app/
```

## 工作流程

### 上传 PDF 后的链接格式

上传成功后，返回的链接格式为：
```
{QINIU_DOMAIN}/文件名.pdf
```

**示例**：
- 如果 `QINIU_DOMAIN=http://survival-skills-pdfs.z0.glb.clouddn.com`
- 上传的文件名：`1234567890-test.pdf`
- 最终链接：`http://survival-skills-pdfs.z0.glb.clouddn.com/1234567890-test.pdf`

### 用户访问流程

1. 用户在网站点击文章
2. 文章链接指向七牛云的 PDF 链接
3. 浏览器直接访问七牛云的文件
4. 文件从七牛云 CDN 加载（速度快）

## 如果想让 PDF 通过 Vercel 域名访问

如果您**必须**通过 Vercel 域名访问 PDF（不推荐），需要：

1. **配置 Vercel 代理**：
   - 在 `next.config.mjs` 中添加重写规则
   - 将 `/pdfs/*` 代理到七牛云

2. **增加复杂性**：
   - 需要额外的配置
   - 会增加 Vercel 的流量消耗
   - 访问速度可能变慢

**不推荐**这种方式，因为：
- 七牛云 CDN 已经很快
- 直接访问七牛云链接更简单
- 不需要额外配置

## 推荐方案

### 短期（测试阶段）

使用七牛云测试域名：
```
QINIU_DOMAIN=http://survival-skills-pdfs.z0.glb.clouddn.com
```

### 长期（生产环境）

绑定自定义域名：
```
QINIU_DOMAIN=https://pdfs.yourdomain.com
```

## 总结

- ❌ **不能**使用 Vercel 域名作为 `QINIU_DOMAIN`
- ✅ **应该**使用七牛云提供的测试域名或自定义域名
- ✅ **推荐**绑定自定义域名以获得永久链接
- ✅ **直接访问**七牛云链接是最简单、最快的方式

## 下一步

1. 登录七牛云控制台
2. 查看存储空间的测试域名
3. 将测试域名配置到 Vercel 环境变量 `QINIU_DOMAIN`
4. 重新部署项目
5. 测试上传功能

