# PDF 文件大小限制说明

## 文件大小限制

### GitHub 存储
- **推荐大小**：< 10MB
- **最大限制**：约 15MB（base64 编码后约 20MB）
- **原因**：GitHub API 对 base64 编码后的内容有大小限制，且上传大文件容易超时

### Cloudflare R2 / 七牛云存储
- **推荐大小**：< 100MB
- **最大限制**：理论上无限制（但建议 < 100MB 以保证上传速度）

## 17MB 文件的问题

17MB 的 PDF 文件：
- ❌ **无法通过 GitHub 上传**（超过 10MB 限制）
- ✅ **可以通过 Cloudflare R2 上传**
- ✅ **可以通过七牛云上传**

## 解决方案

### 方案 1：压缩 PDF 文件（推荐）

如果文件可以压缩到 < 10MB，可以继续使用 GitHub：

1. **使用在线工具压缩**：
   - https://www.ilovepdf.com/compress-pdf
   - https://smallpdf.com/cn/compress-pdf
   - https://www.pdf2go.com/zh/compress-pdf

2. **使用 Adobe Acrobat**：
   - 打开 PDF
   - 文件 → 另存为 → 优化 PDF
   - 选择压缩级别

3. **使用命令行工具**（如果有）：
   ```bash
   # 使用 Ghostscript 压缩
   gs -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dPDFSETTINGS=/ebook -dNOPAUSE -dQUIET -dBATCH -sOutputFile=compressed.pdf original.pdf
   ```

### 方案 2：配置 Cloudflare R2（推荐大文件）

如果文件无法压缩，或有很多大文件，建议配置 R2：

1. **优点**：
   - 支持大文件（< 100MB）
   - 免费 10GB 存储
   - 免费 1M 次读取/月
   - 上传速度快

2. **配置步骤**：
   - 参考：`Cloudflare R2配置指南.md`
   - 在 Vercel 环境变量中配置 R2 相关变量

### 方案 3：配置七牛云（国内用户推荐）

如果文件无法压缩，且在国内访问：

1. **优点**：
   - 支持大文件
   - 免费 10GB 存储
   - 免费 10GB/月 下载流量
   - 国内访问速度快

2. **配置步骤**：
   - 参考：`七牛云配置详细指南.md`
   - 在 Vercel 环境变量中配置七牛云相关变量

## 当前错误提示

如果上传 17MB 文件时看到：
```
文件太大（17.0MB）。GitHub 仅支持 < 10MB 的文件。请压缩 PDF 或配置 Cloudflare R2/七牛云存储。
```

这表示：
- ✅ 代码已正确检测到文件大小
- ❌ 文件超过 GitHub 限制
- 💡 需要压缩文件或配置其他存储服务

## 快速选择

| 文件大小 | 推荐方案 | 原因 |
|---------|---------|------|
| < 10MB | GitHub | 简单，无需额外配置 |
| 10-30MB | 压缩到 < 10MB 或使用 R2/七牛云 | GitHub 限制 |
| > 30MB | R2 或七牛云 | 必须使用外部存储 |

## 测试建议

1. **先尝试压缩**：
   - 如果压缩后 < 10MB → 使用 GitHub
   - 如果压缩后仍 > 10MB → 配置 R2/七牛云

2. **如果有很多大文件**：
   - 直接配置 R2 或七牛云
   - 避免频繁压缩的麻烦

## 常见问题

### Q: 为什么 GitHub 限制是 10MB？

A: GitHub API 对 base64 编码后的内容有实际限制。10MB 的文件 base64 编码后约 13-14MB，在安全范围内。更大的文件容易超时或失败。

### Q: 压缩会影响 PDF 质量吗？

A: 取决于压缩级别：
- **轻度压缩**：质量损失小，文件可能仍 > 10MB
- **中度压缩**：质量可接受，通常可压缩到 < 10MB
- **重度压缩**：质量明显下降，但文件很小

### Q: 如何知道文件压缩后的大小？

A: 使用在线压缩工具，上传后可以看到压缩后的大小，再决定是否使用。


